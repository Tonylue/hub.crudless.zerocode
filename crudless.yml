version: "1.0"
## 参考 docker-compose.yaml 的编排方式，对自动化生成应用进行编排

meta:
  author: 作者
  createTime: 创建时间
  updateTime: 更新时间

  # pom: # pom 信息
  #     version: 1.0.0 #版本号
  #     artifact: crudless
  # service_meta: # 服务装配信息
  #     service_name: tickets # 独立服务组别名称
  #     service_tag: 2341512341234 # 服务索引
  #     service_title: 问题管理 # 标题
  #     service_category: OA # 分类信息
  #     target_domain: dev.cloud.smallsaas.cn #装配目地址
  #  api:
  #     create_time: 创建时间 #
  #     build_time: 2020-06-11 # 更新时间
  #     developer: josie # 服务开发者名称
  #     jar_repo_url: http://jar.smallsaas.cn/repositories/issue-1.0.0.jar #jar包地址
  #     jar_dependencies_url: http://jar.smallsaas.cn/dependencies/tree/issue_dependencies.json
  #  js:
  #     create_time: 2020-08-01 # 创建时间
  #     build_time: 2020-06-11 # 更新时间
  #     developer: ling #前端开发者名称
  #     js_page_url: http://jar.smallsaas.cn/repository/issue #前端面页

auth:
  ## wechat, github, account
  sso: github
  ## 是否可注册, allow,none
  reg: none
  ## 底图可配置,也可以纯色
  bg: url

ui:
  ##  风格: 白天,黑夜,蓝天,草原,彩霞,浪漫
  theme: Light
  ## 应用布局 (菜单） top, left
  layout: top

entries:
  -   # means entry_name
    dev_name: product_mgr   # 用于装配服务时定位菜单入口
    label: 产品管理
    path: /products
    icon: static/product_entry.png   # 服务组可配置图标
    #app_id: demo  # 用于授权 (暂时忽略)
    #app_secret: AJOI7800AFJEO7AOFE   # 用于授权 (暂时忽略)
    sub_entries:
       -
          dev_name: product_type
          path: /products/types
          label: 产品分类
          path: /products/types
          #app_id: demo  # 用于授权 (暂时忽略)
          #app_secret: AJOI7800AFJEO7AOFE   # 用于授权 (暂时忽略)
       -
          dev_name: product_tag
          label: 产品标签
          path: /products/tags
       -
          dev_name: product
          label: 产品
          path: /products/product
  -
    dev_name: orders
    label: 单订管理
    icon: static/orders_entry.png
  -
    dev_name: ticket_mgr
    label: 工单管理
    icon: static/ticket_entry.png
    path: /issues   # 需要匹配pages/下面的路径，用于面包屑显示
    sub_entries:
       -
          dev_name: ticket_issues
          label: 问题管理
          path: /issues/issue   # 需要匹配pages/下面的路径

pages:
  issue:  # 与匹配pages/ 下面的终端路径一致，即 pages/issues/issue
    api: /api/crud/issues/issue
    description: "API for Issues"
    service_provider: native  # 默认native-通过配置sql定义生成, external-拼接外部服务

    features: # 实体能力(capability)
      - saas # 具备 saas 能力，默认增加字段 org_id, org_tag
      - tag # 具备 tag 功能
      - image # 具备 image snapshot 功能
      - eav # 自定义字段
      - category # 一般分组，通过 crud-category
      #- group    #独立表进行分组, 与category只能选其一

    cg: #自动代码配置
      master: t_issue
      #group: t_issue_category
      slaves:
        - t_issue_item:items
        - t_issue_tag:tags

    list:
      search: # 搜索条件
        fields:
          - 
            label: 搜索
            field: search
            type: input
        tab: # 展开分类
          field: status
          all: default # default 默认包括全部选项, none 代表没有全部选项
          options:
            Open: 打开
            Draft: 草稿
      actions:
        - 
          title: 导出
          type: export-excel
          api: /api/io/excel/teamReward
          data: teamReward
          scope: top
        - 
          title: 新建
          type: path   # 通过路径跳转
          scope: top
        - 
          title: 导入
          type: import-excel #导入excel
          #api: /api/io/undefined
          scope: top
        - 
          title: 打印
          type: print #打印
          #api: /api/io/undefined
          scope: top
        - 
          title: 编辑
          type: path
          outside: true # 操作入口显示在外面
          scope: item # 默认为列表项操作
        - 
          title: 删除
          type: delete
          outside: false # 默认为 隐藏入口
          #scope: item    # 没有定义默认为列表项操作
        - 
          title: 提交
          type: meta # meta 状态跳转
          scope: item
        - 
          title: 提交
          type: meta # 元操作
          scope: batch # 批量操作(标准化元操作)
        - 
          title: 审批
          scope: batch # 批量操作(标准化元操作)
        - 
          title: 拒绝
          scope: batch # 批量操作(标准化元操作)

    form:
      columns: 2 # 表单将按照两列的形式排版显示

    fields:
      ## name 字段
      name:
        label: 名称
        type: input
        tips: 请输入名称
        props:
          placeholder: 请输入
        rules:
          - required # 非空
        scope:
          - list
          - view
          - new
          - edit
        # 数据字段属性
        sql:
          type: varchar(100)
          notnull: true
          comment: 名称
          unique: true

      #sex  单选字段
      sex:
        label: 性别
        type: radio
        options:
          0: 男
          1: 女
        scope:
          - list
          - view
          - new
          - edit
        sql:
          type: varchar(1)
          comment: "性别"

      ## phone 手机号,
      phone:
        label: 手机号
        type: input
        tips: 请输入手机号
        rules: # "phone" 为验证手机格式
          - 
            type: required
            message: 请输入手机号
          - 
            type: phone
            message: 手机号码格式不正确
          #- email #邮箱地址检查
        scope:
          - list
          - view
          - new
          - edit
        # 数据字段属性
        sql:
          type: varchar(100)
          comment: "手机号"

      # status 选项字段
      status:
        label: 状态
        type: select
        options:
          OPEN:
            label: 开放
            color: "#1890ff"
          DRAFT:
            label: 草稿
            color: "#1890ff"
        scope: #  不能直接编辑状态
          - list
          - view
          - new
        sql:
          type: varchar(25)
          notnull: true
          comment: "状态"
          default: OPEN

      # creatTime 日期字段
      createTime:
        label: 创建时间
        type: date
        scope:
          - list
          - view
        sql:
          type: datetime
          notnull: true
          comment: "创建时间"
          default: CURRENT_TIMESTAMP

      # descriptions 文本字段
      descriptions:
        label: 备注
        type: text-area
        props:
          autoSize:
            minRows: 4 #设置文本框高度
          placeholder: 请输入……
        scope:
          - all
        sql:
          type: varchar(255)
          comment: "备注"

initialize: #执行初始化(仅一次)
  - teamReward
  - teamMachineState #状态机

---
profiles:
  teamReward:
    type: export-excel
    sql: SELECT '申请' as '名称',(CASE Open WHEN 'Open' THEN '打开' WHEN '2' THEN '提交' END) as '状态' FROM (select 'Open') t
  teamMachineState:
    type: meta
    config:
      - from: START
        to: OPEN
      - from: OPEN
        to: SUBMITTED
